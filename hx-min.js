var HXGlobalJS=function(){"use strict";void 0===window.hxLocalOptions&&(window.hxLocalOptions={}),void 0===window.HXPUPTimer&&(window.HXPUPTimer=[]),void 0===window.HXChimeTimer&&(window.HXChimeTimer=[]);var e,t,i,n,s,a,o,l={makeTOC:!1,collapsedNav:!1,openPageDiscussion:!1,resizeMaps:!0,markExternalLinks:!1,useBackpack:!0,highlightColor:"#ff0",highlightBackground:"rgba(0,0,0,0)",highlightState:!0,highlightCode:!0,slickOptions:{arrows:!0,dots:!0,focusOnChange:!0,infinite:!0,slidesToShow:3,slidesToScroll:3},slickNavOptions:{asNavFor:".hx-bigslider",variableWidth:!0,focusOnSelect:!0,slidesToShow:3,slidesToScroll:1},slickBigOptions:{asNavFor:".hx-navslider",arrows:!1,dots:!0,fade:!0,focusOnChange:!0,adaptiveHeight:!0,slidesToShow:1,slidesToScroll:1},textSliderOptions:{slidesFile:"TextSliderCards.csv",startingSlide:"",slideScope:[],overviewIsOpen:!1,showBottomNav:!0,maxIconsTall:2,causeEffect:["Causes","Effects"]},PUPOptions:{width:800,effect:"fade",effectlength:200,myPosition:"center",atPosition:"center",ofTarget:window},VidLinkOptions:{hideLinkAfter:5,effect:"slide",hide:{direction:"down"},show:{direction:"down"},speed:500,location:"bl"},HXEditorOptions:[["style",["style"]],["font",["bold","italic","underline","clear"]],["color",["color"]],["para",["ul","ol","paragraph"]],["table",["table"]],["insert",["link"]],["view",["fullscreen","codeview","help"]],],ChimeOptions:{}},r=P(window.location.href,"complete");if(V(r),P(window.location.href,"site").indexOf("studio")>-1){console.log("Running HXJS in studio is probably not great. Quitting.");return}let h,c;var d=(e=window.location.href,h=P(e,"partial"),c={},h=h.split(":")[2],c.institution=h.split("+")[0],c.id=h.split("+")[1],c.run=h.split("+")[2],c),p=d.institution+"."+d.id+"_"+d.run;V({"HX.js":"enabled"}),V({"course log id":p}),Logger.listen("problem_check",null,(e,t)=>C(e,t)),Logger.listen("problem_show",null,(e,t)=>C(e,t)),Logger.listen("problem_reset",null,(e,t)=>C(e,t)),$.getMultiScripts=function(e,t){var i=$.map(e,function(e){return $.getScript((t||"")+e)});return i.push($.Deferred(function(e){$(e.resolve)})),$.when.apply($,i)};var g=[],u={};g.push("hxGlobalOptions.js");var f=$("code");f.length&&(V({code_block:"found"}),g.push("prism.js"));var m=$(".hx-slider"),x=$(".hx-navslider"),k=$(".hx-bigslider");(m.length||x.length&&k.length)&&(V({image_slider:"found"}),g.push("slick.js"));var v=$(".hx-dynamic-sliderbox");v.length&&(V({dynamic_slider:"found"}),g.push("papaparse.js"),g.push("hx-text-slider.js"));var b=$("map");b.length&&(V({image_map:"found"}),g.push("imageMapResizer.min.js"));var y=$(".hx-editor:visible");y.length>0&&(V({editor:"found"}),g.push("summernote-lite.min.js"),g.push("HXEditor.js"));var O=!0;window.hxLocalOptions.dontLoadVideoStuff,!0===window.hxLocalOptions.dontLoadVideoStuff&&(O=!1,console.log("skipping loading video js"));var T=$(".video");function w(e){if(window.hxOptions=e,console.log("Window hxOptions set"),0===$("#hxbackpackframe").length&&e.useBackpack){let t=P(window.location.href,"site")+"block-v1:"+d.institution+"+"+d.id+"+"+d.run+"+type@problem+block@backpack",h=$("<iframe></iframe>");h.attr("src",t),h.attr("id","hxbackpackframe"),h.attr("aria-hidden","true"),h.attr("tabindex","-1"),h.css("display","none"),$("body").append(h)}if(y.length){$("head").append($('<link rel="stylesheet" href="'+r+'summernote-lite.min.css" type="text/css" />'));let c=$('<div class="hx-loading-indicator"> Editor loading...</div>'),p=$('<span class="fa fa-spinner fa-pulse"></span>');c.prepend(p),y.append(c),hxBackpackLoaded&&void 0===n?n=new HXEditor(e.useBackpack,e.HXEditorOptions):(console.log("Backpack: "+hxBackpackLoaded),console.log("HXED: "+typeof n=="undefined"?"undefined":"ok"))}T.length>0&&O&&($("head").append($('<link rel="stylesheet" href="'+r+'VideoLinks.css" type="text/css" />')),s=new HXVideoLinks(e.VidLinkOptions),$(".jumptime").on("click tap",function(e){e.preventDefault();let t=1;void 0!==$(this).attr("data-for-vidnum")&&(t=$(this).attr("data-for-vidnum"));D(t,E($(this).attr("href")))}),0!==window.HXPUPTimer.length&&(a=new HXPopUpProblems(l.PUPOptions,window.HXPUPTimer)),0!==window.HXChimeTimer.length&&(o=new HXVideoChime(l.ChimeOptions,window.HXChimeTimer))),b.length&&e.resizeMaps&&$("map").imageMapResize(),f.length&&e.highlightCode&&$("head").append($('<link rel="stylesheet" href="'+r+'prism.css" type="text/css" />'));let g=Array.from(document.getElementsByClassName("hx-survey-url"));if(g.length){V({hx_surveys:"found"});let u=Array.from(document.getElementsByClassName("hx-survey-url")),w=u.map(function(e){return"a"===e.tagName.toLowerCase()?e.href:"iframe"===e.tagName.toLowerCase()?e.src:e.innerText}),C=w.map(e=>e+"&university="+d.institution+"&course_id="+d.id+"&course_run="+d.run);u.forEach(function(e,t){"a"===e.tagName.toLowerCase()?e.href=C[t]:"iframe"===e.tagName.toLowerCase()?e.src=C[t]:e.innerText=C[t]})}$("a.hx-vidtime").on("click tap",function(){let e=E($(this).attr("data-time")),t=$(this).attr("href"),i=t.slice(t.indexOf("#video")).replace("#video",""),n=t.slice(t.indexOf("/jump_to_id/")+13,t.indexOf("#video"));0===t.indexOf("#")?(V({"link starts video at time":e}),s.jumpToTime(i,e)):(localStorage.HXVideoLinkGo="true",localStorage.HXVideoLinkUnit=n,localStorage.HXVideoLinkNumber=i,localStorage.HXVideoLinkTime=e,V({"storing video info for jump":{unit:n,"video number":i,time:e}}))}),e.collapsedNav&&($(".sequence-nav").hide(),$(".sequence > .path").hide(),$("h3.unit-title").hide());let _=$("#hx-tint");_.length&&$(_).on("click tap",function(){$("p").animate({color:"blue"})}),e.openPageDiscussion&&$(".discussion-show.btn").click(),e.markExternalLinks&&(V("marking external links"),$(".vert .xblock a, .static_tab_wrapper .xblock a").each(function(e,t){j($(t).attr("href"))&&$(t).append(' <span class="fa fa-external-link"><span class="sr">External link</span></span>')}));let H,L;X("hx-togglebutton","hx-toggletarget","hx-toggleremember"),$("[class^=hx-highlighter]").on("click tap",function(){let t=N(this.className,"hx-highlighter");e.highlightState?$(".hx-highlight"+t).css({"background-color":e.highlightColor,transition:"background 0.2s"}):$(".hx-highlight"+t).css({"background-color":e.highlightBackground,transition:"background 0.2s"}),e.highlightState=!e.highlightState,V({"Highlight button":"pressed","Highlight number":t})}),e.makeTOC&&($(".edx-notes-wrapper-content").length?$(".edx-notes-wrapper-content:first-of-type").prepend('<div id="autoTOC" class="hx-autotoc"></div>'):$($("#seq_content .vert .xblock")[0]).prepend('<div id="autoTOC" class="hx-autotoc"></div>'),H="<h3>Table of Contents</h3><ul>",L=$("h3, h4").filter(function(){return $(this).is(":visible")}),$("#autoTOC ul"),L.each(function(e){$(this).attr("id","TOCLink"+e);let t=$(this).text(),i;$(this).is("h3")&&(i=3,$(L[e-1]).is("h3")||0===e?H+='<li class="autotoc'+i+'"><a href="#TOCLink'+e+'">'+t+"</a></li>":$(L[e-1]).is("h4")&&(H+='</ul></li><li class="autotoc'+i+'"><a href="#TOCLink'+e+'">'+t+"</a></li>")),$(this).is("h4")&&(i=4,$(L[e-1]).is("h3")?(e>0&&H.slice(0,H.length-5),H+='<ul><li class="autotoc'+i+'"><a href="#TOCLink'+e+'">'+t+"</a></li>"):$(L[e-1]).is("h4")&&(H+='<li class="autotoc'+i+'"><a href="#TOCLink'+e+'">'+t+"</a></li>"))}),H+="</ul>",$("#autoTOC").append(H));$(".hx-popup-opener").length&&($("map").each(function(e){let t=[];$(this).find("area").each(function(e){t.push('<li class="'+this.className.split(/\s+/)[0]+' hx-popup-opener" title="'+this.title+'"><a href="javascript:;">'+this.title+"</a></li>")});let i="<ul>"+t.join("")+"</ul>";i="<h4>Clickable Areas:</h4>"+i;let n=$(this).data("make-accessible-list");"false"===n||!1===n||$(this).after(i)}),$(".hx-popup-opener").on("click tap",function(e){let t=this.className.split(/\s+/)[0];$("div."+t).dialog({dialogClass:"hx-popup-dialog",title:$(this).attr("title"),position:{my:"center",at:"center",of:$(e.target)},show:{effect:"fade",duration:200},hide:{effect:"fade",duration:100},buttons:{Close:function(){$(this).dialog("close")}}},function(e){$("div."+e).css({display:""}),alert(e)}),V({"Pop-up Dialog":"opened",Dialog:t})}));let S=$('span[class^="hx-footnote"]');S.length&&function e(t){let i,n,s,a,o;for(let l=0;l<t.length;l++)n=N((i=t[l]).className,"hx-footnote"),s=$("div.hx-footnote-target"+n),$(i).addClass("hx-footnote-style"),$(i).wrap("<sup></sup>"),a=$('h3:contains("Footnote")'),o=$(a[a.length-1]).parent(),$(s).detach().appendTo(o),$(i).wrap('<a href="#hxfoot'+n+'" name="hxfootback'+n+'"></a>').wrap(),s.prepend('<a name="hxfoot'+n+'"></a>'),s.append('<p><a href="#hxfootback'+n+'">(back)</a></p>')}(S),v.length&&($("head").append($('<link rel="stylesheet" href="'+r+'hx-text-slider.css" type="text/css" />')),console.log(e.textSliderOptions),i=new HXTextSlider(e.textSliderOptions),V({"dynamic slider":"created"})),m.length&&($("head").append($('<link rel="stylesheet" href="'+r+'slick.css" type="text/css" />')),$("head").append($('<link rel="stylesheet" href="'+r+'slick-theme.css" type="text/css" />')),m.slick(e.slickOptions),V({slider:"created"})),x.length&&k.length&&($("head").append($('<link rel="stylesheet" href="'+r+'slick.css" type="text/css" />')),$("head").append($('<link rel="stylesheet" href="'+r+'slick-theme.css" type="text/css" />')),x.slick(e.slickNavOptions),k.slick(e.slickBigOptions),V({"paired slider":"created"}))}function C(e,t){console.log(e,t);let i;"problem_check"===e?i=t.split("_")[1]:"problem_show"===e&&(i=t.problem.split("@")[2]);let n=$('[id^="'+i+'"]').parent()[0];setTimeout(function(){S("hx-togglebutton","hx-toggletarget"),f.length&&u.highlightCode&&Prism.highlightAllUnder(n)},500)}function _(e,t){e="toggle_"+e,console.log("set vis of "+e+" to "+t);try{let i=JSON.parse(localStorage.HXToggleMemory);i[e]=t,localStorage.HXToggleMemory=JSON.stringify(i)}catch(n){console.log("error"),console.log(n),localStorage.HXToggleMemory=JSON.stringify({[e]:t})}}function H(e,t,i,n){console.log("hiding"),$.ui?$("."+t+n).hide("slide",{direction:"up"},"fast"):$("."+t+n).hide(),$("."+e+n).attr("aria-expanded","false"),$("."+t+n).attr("aria-hidden","true"),$(".hx-toggleset ."+e+n).siblings().attr("disabled",!1),i&&_(n,!1)}function L(e,t,i,n){console.log("showing"),$.ui?$("."+t+n).show("slide",{direction:"up"},"fast"):$("."+t+n).show(),$("."+e+n).attr("aria-expanded","true"),$("."+t+n).attr("aria-hidden","false"),$(".hx-toggleset ."+e+n).siblings().attr("disabled",!0),i&&_(n,!0)}function S(e,t){console.log("setting visibility from memory");let i=[];$("[class*="+t+"]").each(function(){let n=N(this.className,t);if(console.log("toggle "+n+"..."),-1===i.indexOf(n)){i.push(n);let s=function e(t){t="toggle_"+t;let i=!1;try{i=JSON.parse(localStorage.HXToggleMemory)[t]}catch(n){}return i}(n);null!=s&&(s?(console.log("...should be shown. Showing it."),L(e,t,!1,n)):(console.log("...should be hidden. Hiding it."),H(e,t,!1,n)))}else console.log("...is already handled.")})}function X(e,t,i){let n=[];$("[class*="+e+"]").each(function(){let i=N(this.className,e);-1===n.indexOf(i)&&(console.log("prepping toggle "+i),n.push(i),$("."+t+i+":visible").length>0?($("."+e+i).attr("aria-expanded","true"),$("."+t+i).attr("aria-hidden","false")):($("."+e+i).attr("aria-expanded","false"),$("."+t+i).attr("aria-hidden","true")))}),S(e,t),$(".hx-clearmemory").on("click tap",function(){let t=N(this.className,e);null!==t?_(t,void 0):localStorage.HXToggleMemory=""}),$("[class*="+e+"]").on("click tap",function(){var n,s,a;let o=N(this.className,e),l=$(this).hasClass(i),r="";"true"===$(this).attr("aria-expanded")?(r="invisible",H(e,t,l,o,$(document))):(r="visible",L(e,t,l,o,$(document)),1===$("."+t+o).length&&(n=$("."+t+o)[0],s=n.getBoundingClientRect(),a=Math.max(document.documentElement.clientHeight,window.innerHeight),s.bottom<0||s.top-a>=0)&&$("."+t+o)[0].scrollIntoView()),V({"Toggle button":"pressed","Toggled to":r,"Toggle number":o})})}function j(e){return!!(void 0!==e&&isNaN(E(e)))&&!(e.includes("edx.org")||e.includes("edxapp")||e.includes("edx-cdn.org")||e.includes("edx-video.net")||e.includes("/courses/")||e.includes("/assets/courseware/")||e.includes("jump_to_id")||e.includes("cloudfront.net")||e.includes("mailto")||e.includes("javascript:void")||e.includes("javascript:;"))&&"#"!=e.slice(0,1)}function P(e,t){e.includes("%2B")&&(e=e.replace("%2B","+")),e.includes("%3A")&&(e=e.replace("%3A",":"));let i=e.match(/https:\/\/.+\//)[0];if("site"==t)return i;let n=e.replace("courses/course","asset");n.search("xblock/block-v1")>-1&&(n=(n=n.replace("xblock/block","asset")).replace("+type@","/"));let s=n.indexOf("+"),a=n.indexOf("/",s);return(n=n.slice(0,a),n+="+type@asset+block/","partial"==t)?n.replace(i,""):n}function N(e,t){let i=e.split(/\s+/);for(let n=0;n<i.length;n++)if(0===i[n].indexOf(t))return i[n].slice(t.length);return null}function B(e,t,i){let n={};return e||t?n=e?t?$.extend(!0,{},i,t,e):$.extend(!0,{},i,e):$.extend(!0,{},i,t):i}function E(e){let t=(e=e.toString()).split(":"),i=0;return 3==t.length?i=3600*parseInt(t[0])+60*parseInt(t[1])+Number(t[2]):2==t.length?i=60*parseInt(t[0])+Number(t[1]):1==t.length&&(i=Number(t[0])),i}function D(e,t){let i=$(".video")[e-1],n=$(i).data("video-player-state");void 0!==n.videoPlayer?(console.log("jumping video "+e+" to time "+t),i.scrollIntoView(),n.videoPlayer.player.seekTo(t)):console.log("video "+e+" not ready")}function V(e){console.log(JSON.stringify(e)),Logger.log(p+".hxjs",e)}O&&T.length>0&&(V({video:"found"}),g.push("HXVideoLinks.js"),window.HXPUPTimer.length>0&&g.push("HXPopUpProblems.js"),window.HXChimeTimer.length>0&&g.push("HXVideoChime.js")),$.getMultiScripts(g,r).done(function(){V({"Loaded scripts":g}),w(u=hxGlobalOptions?B(window.hxLocalOptions,hxGlobalOptions,l):B(window.hxLocalOptions,{},l))}).fail(function(e,t,i){console.log(e),console.log(t),console.log(i),V({script_load_error:t}),w(u=B(window.hxLocalOptions,{},l))}),(t=jQuery).fn.hxKonami=function(e,i){return void 0===i&&(i="38,38,40,40,37,39,37,39,66,65"),this.each(function(){let n=[];t(this).keydown(function(t){for(n.push(t.keyCode);n.length>i.split(",").length;)n.shift();n.toString().indexOf(i)>=0&&(n=[],e(t))})})},$(window).hxKonami(function(){alert("+30 Lives"),V({"easter egg":"Konami Code"})}),$(window).off("message.hx").on("message.hx",function(e){var t=e.originalEvent.data;if(e.originalEvent.origin===location.origin&&"string"==typeof t&&"backpack_ready"===t){console.log("Backpack ready.");let i=$("#hxbackpackframe")[0].contentWindow;window.hxSetData=i.hxSetData,window.hxClearData=i.hxSetData,window.hxGetData=i.hxGetData,window.hxGetAllData=i.hxGetAllData,window.hxBackpackLoaded=i.hxBackpackLoaded,u.useBackpack&&y.length>0&&void 0===n&&(n=new HXEditor(u.useBackpack,u.HXEditorOptions))}}),window.getAssetURL=P,window.hmsToTime=E,window.timeToHMS=function e(t){var i,n,s,a="";return i=Math.floor((t=Math.floor(t))/3600),(n=Math.floor(t/60%60))<10&&(n="0"+n),(s=Math.floor(t%60))<10&&(s="0"+s),a="0:"+s,n>0&&(a=n+":"+s),i>0&&(a=i+":"+n+":"+s),a},window.logThatThing=V,window.prepAccessibleToggles=X,window.isExternalLink=j,window.popDataMap=function e(){console.log("Open full-sized map image.");let t=$("#mapframe"),i=t.contents().find("#LargeMapView");t.toggleClass("hx-svg-view"),t.hasClass("hx-svg-view")?i.text("View Regular"):i.text("View Large")},window.jumpToTime=D,window.hxBackpackLoaded=$("#hxbackpackframe").length>0};$(document).ready(function(){if(void 0!==window.hxjs_is_already_running){console.log("hx-js is already loaded, skipping this copy.");return}window.hxjs_is_already_running=!0,HXGlobalJS()});