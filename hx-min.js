if(void 0===hxLocalOptions)var hxLocalOptions={};if(void 0===HXPUPTimer)var HXPUPTimer=[];if(void 0===HXChimeTimer)var HXChimeTimer=[];var HXGlobalJS=function(e,t,i){"use strict";var s={makeTOC:!1,collapsedNav:!1,makeSmiles:!0,openPageDiscussion:!1,resizeMaps:!0,markExternalLinks:!1,highlightColor:"#ff0",highlightBackground:"rgba(0,0,0,0)",highlightState:!0,highlightCode:!0,slickOptions:{arrows:!0,dots:!0,focusOnChange:!0,infinite:!0,slidesToShow:3,slidesToScroll:3},slickNavOptions:{asNavFor:".hx-bigslider",variableWidth:!0,focusOnSelect:!0,slidesToShow:3,slidesToScroll:1},slickBigOptions:{asNavFor:".hx-navslider",arrows:!1,dots:!0,fade:!0,focusOnChange:!0,adaptiveHeight:!0,slidesToShow:1,slidesToScroll:1},textSliderOptions:{slidesFile:"TextSliderCards.csv",startingSlide:"",slideScope:[],overviewIsOpen:!1,showBottomNav:!0,maxIconsTall:2,causeEffect:["Causes","Effects"]},PUPOptions:{width:800,effect:"fade",effectlength:200,myPosition:"center",atPosition:"center",ofTarget:window},VidLinkOptions:{hideLinkAfter:5,effect:"slide",hide:{direction:"down"},show:{direction:"down"},speed:500,location:"bl"},ChimeOptions:{}},n=b(window.location.href,"complete");if(y(n),b(window.location.href,"site").indexOf("studio")>-1)console.log("Running HXJS in studio is probably not great. Quitting.");else{var o=function(e){let t=b(e,"partial"),i={};return t=t.split(":")[2],i.institution=t.split("+")[0],i.id=t.split("+")[1],i.run=t.split("+")[2],i}(window.location.href),a=o.institution+"."+o.id+"_"+o.run;y({"HX.js":"enabled"}),y({"course log id":a}),$.getMultiScripts=function(e,t){var i=$.map(e,function(e){return $.getScript((t||"")+e)});return i.push($.Deferred(function(e){$(e.resolve)})),$.when.apply($,i)};var l=[];l.push("hxGlobalOptions.js");var r=$("code");r.length&&(y({code_block:"found"}),l.push("prism.js"));var c=$(".hx-slider"),h=$(".hx-navslider"),d=$(".hx-bigslider");(c.length||h.length&&d.length)&&(y({image_slider:"found"}),l.push("slick.js"));var p=$(".hx-dynamic-sliderbox");if(p.length)y({dynamic_slider:"found"}),l.push("papaparse.js"),l.push("hx-text-slider.js");var f=$("map");f.length&&(y({image_map:"found"}),l.push("imageMapResizer.min.js"));var u=!0;void 0!==typeof e.dontLoadVideoStuff&&!0===e.dontLoadVideoStuff&&(u=!1,console.log("skipping loading video js"));var g=$(".video");if(u&&g.length){var x;if(y({video:"found"}),l.push("HXVideoLinks.js"),0!==t.length)l.push("HXPopUpProblems.js");if(0!==i.length)l.push("HXVideoChime.js")}$.getMultiScripts(l,n).done(function(){y({"Loaded scripts":l}),m(hxGlobalOptions?O(e,hxGlobalOptions,s):O(e,{},s))}).fail(function(t,i,n){console.log(t),console.log(i),console.log(n),y({script_load_error:i}),m(O(e,{},s))}),function(e){e.fn.hxKonami=function(t,i){return void 0===i&&(i="38,38,40,40,37,39,37,39,66,65"),this.each(function(){let s=[];e(this).keydown(function(e){for(s.push(e.keyCode);s.length>i.split(",").length;)s.shift();s.toString().indexOf(i)>=0&&(s=[],t(e))})})}}(jQuery),$(window).hxKonami(function(){alert("+30 Lives"),y({"easter egg":"Konami Code"})}),window.getAssetURL=b,window.hmsToTime=T,window.timeToHMS=function(e){var t,i,s,n="";return e=Math.floor(e),t=Math.floor(e/3600),(i=Math.floor(e/60%60))<10&&(i="0"+i),(s=Math.floor(e%60))<10&&(s="0"+s),n="0:"+s,i>0&&(n=i+":"+s),t>0&&(n=t+":"+i+":"+s),n},window.logThatThing=y,window.prepAccessibleToggles=k,window.isExternalLink=v,window.popDataMap=function(){console.log("Open full-sized map image.");let e=$("#mapframe"),t=e.contents().find("#LargeMapView");e.toggleClass("hx-svg-view"),e.hasClass("hx-svg-view")?t.text("View Regular"):t.text("View Large")}}function m(e){if(window.hxOptions=e,console.log("Window hxOptions set"),g.length&&u&&($("head").append($('<link rel="stylesheet" href="'+n+'VideoLinks.css" type="text/css" />')),x=new HXVideoLinks(e.VidLinkOptions),0!==t.length&&new HXPopUpProblems(s.PUPOptions,t),0!==i.length&&new HXVideoChime(s.ChimeOptions,i)),f.length&&e.resizeMaps&&$("map").imageMapResize(),r.length&&e.highlightCode&&($("head").append($('<link rel="stylesheet" href="'+n+'prism.css" type="text/css" />')),$(".submit, .reset").on("click tap",function(){let e=this.closest(".xblock"),t={childList:!0},i=new MutationObserver(function(s){for(var n of s)if("childList"==n.type){$.when(i.disconnect()).done(function(){$.when(Prism.highlightAllUnder(e)).done(function(){setTimeout(function(){i.observe(e,t)},500)})});break}});i.observe(e,t)})),$("a.hx-vidtime").on("click tap",function(){let e=T($(this).attr("data-time")),t=$(this).attr("href"),i=t.slice(t.indexOf("#video")).replace("#video",""),s=t.slice(t.indexOf("/jump_to_id/")+13,t.indexOf("#video"));0===t.indexOf("#")?(y({"link starts video at time":e}),x.jumpToTime(i,e)):(localStorage.HXVideoLinkGo="true",localStorage.HXVideoLinkUnit=s,localStorage.HXVideoLinkNumber=i,localStorage.HXVideoLinkTime=e,y({"storing video info for jump":{unit:s,"video number":i,time:e}}))}),e.collapsedNav&&($(".sequence-nav").hide(),$(".sequence > .path").hide(),$("h3.unit-title").hide()),e.makeSmiles){let e=$('<span class="hx-smileystack hx-meh fa-stack fa-lg"><span class="fa fa-circle fa-stack-2x"></span><span class="fa fa-meh-o fa-stack-2x"></span></span>'),t=$('<span class="hx-smileystack hx-smile fa-stack fa-lg"><span class="fa fa-circle fa-stack-2x"></span><span class="fa fa-smile-o fa-stack-2x"></span></span>'),i=$('<span class="hx-smileyspacer"></span>');$(".hx-smileystack").remove(),$(".hx-smileyspacer").remove(),$(".sequence-bottom").prepend(i),$(".sequence-bottom").append(e),$(e).on("click tap",function(){$(e).remove(),$(".sequence-bottom").append(t),y("Smile!")})}let o=$("#hx-tint");o.length&&$(o).on("click tap",function(){$("p").animate({color:"blue"})}),e.openPageDiscussion&&$(".discussion-show.btn").click(),e.markExternalLinks&&(y("marking external links"),$(".vert .xblock a, .static_tab_wrapper .xblock a").each(function(e,t){v($(t).attr("href"))&&$(t).append(' <span class="fa fa-external-link"><span class="sr">External link</span></span>')}));k("hx-togglebutton","hx-toggletarget"),$("[class^=hx-highlighter]").on("click tap",function(){let t=w(this.className,"hx-highlighter");e.highlightState?$(".hx-highlight"+t).css({"background-color":e.highlightColor,transition:"background 0.2s"}):$(".hx-highlight"+t).css({"background-color":e.highlightBackground,transition:"background 0.2s"}),e.highlightState=!e.highlightState,y({"Highlight button":"pressed","Highlight number":t})}),e.makeTOC&&function(){$(".edx-notes-wrapper-content").length?$(".edx-notes-wrapper-content:first-of-type").prepend('<div id="autoTOC" class="hx-autotoc"></div>'):$("#seq_content .xblock:first-of-type").prepend('<div id="autoTOC" class="hx-autotoc"></div>');let e="<h3>Table of Contents</h3><ul>",t=$("h3, h4").filter(function(){return $(this).is(":visible")});$("#autoTOC ul");t.each(function(i){$(this).attr("id","TOCLink"+i);let s,n=$(this).text();$(this).is("h3")&&(s=3,$(t[i-1]).is("h3")||0===i?e+='<li class="autotoc'+s+'"><a href="#TOCLink'+i+'">'+n+"</a></li>":$(t[i-1]).is("h4")&&(e+='</ul></li><li class="autotoc'+s+'"><a href="#TOCLink'+i+'">'+n+"</a></li>")),$(this).is("h4")&&(s=4,$(t[i-1]).is("h3")?(i>0&&e.slice(0,e.length-5),e+='<ul><li class="autotoc'+s+'"><a href="#TOCLink'+i+'">'+n+"</a></li>"):$(t[i-1]).is("h4")&&(e+='<li class="autotoc'+s+'"><a href="#TOCLink'+i+'">'+n+"</a></li>"))}),e+="</ul>",$("#autoTOC").append(e)}(),$(".hx-popup-opener").length&&($("map").each(function(e){let t=[];$(this).find("area").each(function(e){t.push('<li class="'+this.className.split(/\s+/)[0]+' hx-popup-opener" title="'+this.title+'"><a href="javascript:;">'+this.title+"</a></li>")});let i="<ul>"+t.join("")+"</ul>";i="<h4>Clickable Areas:</h4>"+i;let s=$(this).data("make-accessible-list");"false"===s||!1===s||$(this).after(i)}),$(".hx-popup-opener").on("click tap",function(){let e=this.className,t=e.split(/\s+/)[0];$("div."+t).dialog({dialogClass:"hx-popup-dialog",title:$(this).attr("title"),show:{effect:"fade",duration:200},hide:{effect:"fade",duration:100},buttons:{Close:function(){$(this).dialog("close")}}},function(e){$("div."+e).css({display:""}),alert(e)}),y({"Pop-up Dialog":"opened",Dialog:t})}));let a=$('span[class^="hx-footnote"]');a.length&&function(e){let t,i,s,n,o;for(let a=0;a<e.length;a++)t=e[a],i=w(t.className,"hx-footnote"),s=$("div.hx-footnote-target"+i),$(t).addClass("hx-footnote-style"),$(t).wrap("<sup></sup>"),n=$('h3:contains("Footnote")'),o=$(n[n.length-1]).parent(),$(s).detach().appendTo(o),$(t).wrap('<a href="#hxfoot'+i+'" name="hxfootback'+i+'"></a>').wrap(),s.prepend('<a name="hxfoot'+i+'"></a>'),s.append('<p><a href="#hxfootback'+i+'">(back)</a></p>')}(a),p.length&&($("head").append($('<link rel="stylesheet" href="'+n+'hx-text-slider.css" type="text/css" />')),console.log(e.textSliderOptions),new HXTextSlider(e.textSliderOptions),y({"dynamic slider":"created"})),c.length&&($("head").append($('<link rel="stylesheet" href="'+n+'slick.css" type="text/css" />')),$("head").append($('<link rel="stylesheet" href="'+n+'slick-theme.css" type="text/css" />')),c.slick(e.slickOptions),y({slider:"created"})),h.length&&d.length&&($("head").append($('<link rel="stylesheet" href="'+n+'slick.css" type="text/css" />')),$("head").append($('<link rel="stylesheet" href="'+n+'slick-theme.css" type="text/css" />')),h.slick(e.slickNavOptions),d.slick(e.slickBigOptions),y({"paired slider":"created"}))}function k(e,t){$("[class^="+e+"]").each(function(){let i=w(this.className,e);$(this).attr("aria-controls",t+i),$("."+t+i+":visible").length>0?($(this).attr("aria-expanded","true"),$("."+t+i).attr("aria-hidden","false")):($(this).attr("aria-expanded","false"),$("."+t+i).attr("aria-hidden","true"))}),$("[class^="+e+"]").on("click tap",function(){let i=w(this.className,e),s="";var n,o,a;$("."+t+i).slideToggle("fast"),"true"===$(this).attr("aria-expanded")?(s="invisible",$("."+e+i).attr("aria-expanded","false"),$("."+t+i).attr("aria-hidden","true"),$(".hx-toggleset ."+e+i).siblings().attr("disabled",!1)):(s="visible",$("."+e+i).attr("aria-expanded","true"),$("."+t+i).attr("aria-hidden","false"),$(".hx-toggleset ."+e+i).siblings().attr("disabled",!0),1===$("."+t+i).length&&(n=$("."+t+i)[0],o=n.getBoundingClientRect(),a=Math.max(document.documentElement.clientHeight,window.innerHeight),(o.bottom<0||o.top-a>=0)&&$("."+t+i)[0].scrollIntoView())),y({"Toggle button":"pressed","Toggled to":s,"Toggle number":i})})}function v(e){return void 0!==e&&!(e.includes("edx.org")||e.includes("edxapp")||e.includes("edx-cdn.org")||e.includes("/courses/")||e.includes("jump_to_id")||e.includes("cloudfront.net")||e.includes("mailto")||e.includes("javascript:void")||e.includes("javascript:;")||"#"==e.slice(0,1))}function b(e,t){let i=(e=(e=e.replace("%2B","+")).replace("%3A",":")).match(/https:\/\/.+\//)[0];if("site"==t)return i;let s=e.replace("courses/course","asset");s.search("xblock/block-v1")>-1&&(s=(s=s.replace("xblock/block","asset")).replace("+type@","/"));let n=s.indexOf("+"),o=s.indexOf("/",n);return s=s.slice(0,o),s+="+type@asset+block/","partial"==t?s.replace(i,""):s}function w(e,t){let i=e.split(/\s+/);for(let e=0;e<i.length;e++)if(0===i[e].indexOf(t))return i[e].slice(t.length);return-1}function O(e,t,i){let s={};return e||t?s=e?t?$.extend(!0,{},i,t,e):$.extend(!0,{},i,e):$.extend(!0,{},i,t):i}function T(e){let t=(e=e.toString()).split(":"),i=0;return 3==t.length?i=3600*parseInt(t[0])+60*parseInt(t[1])+Number(t[2]):2==t.length?i=60*parseInt(t[0])+Number(t[1]):1==t.length&&(i=Number(t[0])),i}function y(e){console.log(JSON.stringify(e)),Logger.log(a+".hxjs",e)}};$(document).ready(function(){HXGlobalJS(hxLocalOptions,HXPUPTimer,HXChimeTimer)});
