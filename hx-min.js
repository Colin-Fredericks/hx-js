var HXGlobalJS=function(e,i){var t={makeTOC:!1,collapsedNav:!1,makeSmiles:!0,openPageDiscussion:!1,resizeMaps:!0,markExternalLinks:!1,highlightColor:"#ff0",highlightBackground:"rgba(0,0,0,0)",highlightState:!0,slickOptions:{arrows:!0,dots:!0,infinite:!0,slidesToShow:3,slidesToScroll:3},slickNavOptions:{asNavFor:".hx-bigslider",variableWidth:!0,focusOnSelect:!0,slidesToShow:3,slidesToScroll:1},slickBigOptions:{asNavFor:".hx-navslider",arrows:!1,dots:!0,fade:!0,adaptiveHeight:!0,slidesToShow:1,slidesToScroll:1},PUPOptions:{width:800,effect:"fade",effectlength:200,myPosition:"center",atPosition:"center",ofTarget:window},VidLinkOptions:{hideLinkAfter:5,effect:"slide",hide:{direction:"down"},show:{direction:"down"},speed:500,location:"bl"}},a=k(window.location.href,"complete");if(w(a),k(window.location.href,"site").indexOf("studio")>-1)console.log("Running HXJS in studio is probably not great.");else{var o,s,n,l=(o=window.location.href,s=k(o,"partial"),n={},s=s.split(":")[1],n.institution=s.split("+")[0],n.id=s.split("+")[1],n.run=s.split("+")[2],n),r=l.institution+"."+l.id+"_"+l.run;w({"HX.js":"enabled"}),w({"course log id":r}),$.getMultiScripts=function(e,i){var t=$.map(e,function(e){return $.getScript((i||"")+e)});return t.push($.Deferred(function(e){$(e.resolve)})),$.when.apply($,t)};var c=[];c.push("hxGlobalOptions.js");var h=$(".hx-slider"),p=$(".hx-navslider"),d=$(".hx-bigslider");(h.length||p.length&&d.length)&&(w({image_slider:"found"}),c.push("slick.js"));var f=$("map");f.length&&(w({image_map:"found"}),c.push("imageMapResizer.min.js"));var u=!0;void 0!==typeof e.dontLoadVideoStuff&&!0===e.dontLoadVideoStuff&&(u=!1,console.log("skipping loading video js"));var g,m,v=$(".video");if(u)if(v.length)if(w({video:"found"}),c.push("HXVideoLinks.js"),0!==i.length)c.push("HXPopUpProblems.js");$.getMultiScripts(c,a).done(function(){w({"Loaded scripts":c}),x(hxGlobalOptions?O(e,hxGlobalOptions,t):O(e,{},t))}).fail(function(){w("Did not load scripts."),x(O(e,{},t))}),(m=jQuery).fn.hxKonami=function(e,i){return void 0===i&&(i="38,38,40,40,37,39,37,39,66,65"),this.each(function(){var t=[];m(this).keydown(function(a){for(t.push(a.keyCode);t.length>i.split(",").length;)t.shift();t.toString().indexOf(i)>=0&&(t=[],e(a))})})},$(window).hxKonami(function(){alert("+30 Lives"),w({"easter egg":"Konami Code"})}),this.getAssetURL=k,this.hmsToTime=T,this.logThatThing=w}function x(e){if(v.length&&u&&(g=new HXVideoLinks(e.VidLinkOptions),0!==i.length&&new HXPopUpProblems(t.PUPOptions,i)),f.length&&e.resizeMaps&&$("map").imageMapResize(),$("a.hx-vidtime").on("click tap",function(){var e=T($(this).attr("data-time")),i=$(this).attr("href"),t=i.slice(i.indexOf("#video")).replace("#video",""),a=i.slice(i.indexOf("/jump_to_id/")+13,i.indexOf("#video"));0===i.indexOf("#")?(w({"link starts video at time":e}),g.jumpToTime(t,e)):(localStorage.HXVideoLinkGo="true",localStorage.HXVideoLinkUnit=a,localStorage.HXVideoLinkNumber=t,localStorage.HXVideoLinkTime=e,w({"storing video info for jump":{unit:a,"video number":t,time:e}}))}),e.collapsedNav&&($(".sequence-nav").hide(),$(".sequence > .path").hide(),$("h3.unit-title").hide()),e.makeSmiles){var a=$('<span class="hx-smileystack hx-meh fa-stack fa-lg"><span class="fa fa-circle fa-stack-2x"></span><span class="fa fa-meh-o fa-stack-2x"></span></span>'),o=$('<span class="hx-smileystack hx-smile fa-stack fa-lg"><span class="fa fa-circle fa-stack-2x"></span><span class="fa fa-smile-o fa-stack-2x"></span></span>'),s=$('<span class="hx-smileyspacer"></span>');$(".hx-smileystack").remove(),$(".hx-smileyspacer").remove(),$(".sequence-bottom").prepend(s),$(".sequence-bottom").append(a),$(a).on("click tap",function(){$(a).remove(),$(".sequence-bottom").append(o),w("Smile!")})}var n=$("#hx-tint");if(n.length&&$(n).on("click tap",function(){$("p").animate({color:"blue"})}),e.openPageDiscussion&&$(".discussion-show.btn").click(),e.markExternalLinks&&(w("marking external links"),$(".vert .xblock a, .static_tab_wrapper .xblock a").each(function(e,i){var t=$(i).attr("href");void 0!==t&&(t.includes("edx.org")||t.includes("jump_to_id")||t.includes("/courses/")||t.includes("cloudfront.net")||t.includes("javascript:void")||"#"==t.slice(0,1)||$(i).append(' <span class="fa fa-external-link"><span class="sr">External link</span></span>'))})),e.makeTOC){$(".edx-notes-wrapper-content").length?$(".edx-notes-wrapper-content:first-of-type").prepend('<div id="autoTOC" class="hx-autotoc"></div>'):$("#seq_content .xblock:first-of-type").prepend('<div id="autoTOC" class="hx-autotoc"></div>');var l="<h3>Table of Contents</h3><ul>",r=$("h3, h4").filter(function(){return $(this).is(":visible")});$("#autoTOC ul");r.each(function(e){$(this).attr("id","TOCLink"+e);var i,t=$(this).text();$(this).is("h3")&&(i=3,$(r[e-1]).is("h3")||0===e?l+='<li class="autotoc'+i+'"><a href="#TOCLink'+e+'">'+t+"</a></li>":$(r[e-1]).is("h4")&&(l+='</ul></li><li class="autotoc'+i+'"><a href="#TOCLink'+e+'">'+t+"</a></li>")),$(this).is("h4")&&(i=4,$(r[e-1]).is("h3")?(e>0&&l.slice(0,l.length-5),l+='<ul><li class="autotoc'+i+'"><a href="#TOCLink'+e+'">'+t+"</a></li>"):$(r[e-1]).is("h4")&&(l+='<li class="autotoc'+i+'"><a href="#TOCLink'+e+'">'+t+"</a></li>"))}),l+="</ul>",$("#autoTOC").append(l)}$("[class^=hx-togglebutton]").on("click tap",function(){var e=b(this.className,"hx-togglebutton");$(".hx-toggletarget"+e).slideToggle("fast"),w({"Toggle button":"pressed","Toggle number":e})}),$("[class^=hx-highlighter]").on("click tap",function(){var i=b(this.className,"hx-highlighter");e.highlightState?$(".hx-highlight"+i).animate({backgroundColor:e.highlightColor},200):$(".hx-highlight"+i).animate({backgroundColor:e.highlightBackground},200),e.highlightState=!e.highlightState,w({"Highlight button":"pressed","Highlight number":i})});var c=$(".hx-popup-opener");c.length&&($("map").each(function(e){var i=[];$(this).find("area").each(function(e){i.push('<li class="'+this.className.split(/\s+/)[0]+' hx-popup-opener" title="'+this.title+'"><a href="javascript:;">'+this.title+"</a></li>")});var t="<ul>"+i.join("")+"</ul>";t="<h4>Clickable Areas:</h4>"+t,$(this).after(t)}),(c=$(".hx-popup-opener")).on("click tap",function(){var e=this.className.split(/\s+/)[0];$("div."+e).dialog({dialogClass:"hx-popup-dialog",title:$(this).attr("title"),show:{effect:"fade",duration:200},hide:{effect:"fade",duration:100},buttons:{Close:function(){$(this).dialog("close")}}},function(e){$("div."+e).css({display:""}),alert(e)}),w({"Pop-up Dialog":"opened",Dialog:e})}));var m=$('span[class^="hx-footnote"]');if(m.length)for(var x,k,O,S,L,C=0;C<m.length;C++)k=b((x=m[C]).className,"hx-footnote"),O=$("div.hx-footnote-target"+k),$(x).addClass("hx-footnote-style"),$(x).wrap("<sup></sup>"),S=$('h3:contains("Footnote")'),L=$(S[S.length-1]).parent(),$(O).detach().appendTo(L),$(x).wrap('<a href="#hxfoot'+k+'" name="hxfootback'+k+'"></a>').wrap(),O.prepend('<a name="hxfoot'+k+'"></a>'),O.append('<p><a href="#hxfootback'+k+'">(back)</a></p>');h.length&&(h.slick(e.slickOptions),w({slider:"created"})),p.length&&d.length&&(p.slick(e.slickNavOptions),d.slick(e.slickBigOptions),w({"paired slider":"created"}))}function k(e,i){var t=(e=(e=e.replace("%2B","+")).replace("%3A",":")).match(/https:\/\/.+.org\//)[0];if("site"==i)return t;var a=e.replace("courses/course","asset");a.search("xblock/block-v1")>-1&&(a=(a=a.replace("xblock/block","asset")).replace("+type@","/"));var o=a.indexOf("+"),s=a.indexOf("/",o);return a=a.slice(0,s),a+="+type@asset+block/","partial"==i?a.replace(t,""):a}function b(e,i){for(var t=e.split(/\s+/),a=0;a<t.length;a++)if(0===t[a].indexOf(i))return t[a].slice(i.length);return-1}function O(e,i,t){return e||i?e?i?$.extend(!0,{},t,i,e):$.extend(!0,{},t,e):$.extend(!0,{},t,i):t}function T(e){var i=(e=e.toString()).split(":"),t=0;return 3==i.length?t=3600*parseInt(i[0])+60*parseInt(i[1])+Number(i[2]):2==i.length?t=60*parseInt(i[0])+Number(i[1]):1==i.length&&(t=Number(i[0])),t}function w(e){console.log(JSON.stringify(e)),Logger.log(r+".hxjs",e)}};if(void 0===hxLocalOptions)var hxLocalOptions={};if(void 0===HXPUPTimer)var HXPUPTimer=[];$(document).ready(function(){HXGlobalJS(hxLocalOptions,HXPUPTimer)});