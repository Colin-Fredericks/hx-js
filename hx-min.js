var HXGlobalJS=function(i,t){function e(i){m.length&&(b=new HXVideoLinks(i.VidLinkOptions),0!==t.length&&(O=new HXPopUpProblems(h.PUPOptions,t)));var e=$("a.hx-vidtime");if(e.on("click tap",function(){var i=l($(this).attr("data-time")),t=$(this).attr("href"),e=t.slice(t.indexOf("#video")),o=e.replace("#video",""),n=t.slice(t.indexOf("/jump_to_id/")+13,t.indexOf("#video")),s=0===t.indexOf("#")?!0:!1;s?(r({"link starts video at time":i}),b.jumpToTime(o,i)):(localStorage.HXVideoLinkGo="true",localStorage.HXVideoLinkUnit=n,localStorage.HXVideoLinkNumber=o,localStorage.HXVideoLinkTime=i,r({"storing video info for jump":{unit:n,"video number":o,time:i}}))}),i.collapsedNav&&($(".sequence-nav").hide(),$(".sequence-bottom").hide(),$(".sequence > .path").hide()),i.removeAddPostButton&&$(".new-post-btn").hide(),i.openPageDiscussion&&$(".discussion-show").click(),i.markExternalLinks&&(console.log("marking external links"),$(".vert .xblock a").each(function(i,t){var e=$(t).attr("href");e.includes("edx.org")||e.includes("jump_to_id")||e.includes("/courses/")||$(t).append(' <span class="fa fa-external-link"><span class="sr">External link</span></span>')})),i.makeTOC){$("#seq_content .xblock:first-of-type").prepend('<div id="autoTOC" class="hx-autotoc"></div>');var o="<h3>Table of Contents</h3><ul>",n=$("h3, h4").filter(function(){return $(this).is(":visible")});$("#autoTOC ul");n.each(function(i){$(this).attr("id","TOCLink"+i);var t,e=$(this).text();$(this).is("h3")&&(t=3,$(n[i-1]).is("h3")||0==i?o+='<li class="autotoc'+t+'"><a href="#TOCLink'+i+'">'+e+"</a></li>":$(n[i-1]).is("h4")&&(o+='</ul></li><li class="autotoc'+t+'"><a href="#TOCLink'+i+'">'+e+"</a></li>")),$(this).is("h4")&&(t=4,$(n[i-1]).is("h3")?(i>0&&o.slice(0,o.length-5),o+='<ul><li class="autotoc'+t+'"><a href="#TOCLink'+i+'">'+e+"</a></li>"):$(n[i-1]).is("h4")&&(o+='<li class="autotoc'+t+'"><a href="#TOCLink'+i+'">'+e+"</a></li>"))}),o+="</ul>",$("#autoTOC").append(o)}$("[class^=hx-togglebutton]").on("click tap",function(){var i=s(this.className,"hx-togglebutton");$(".hx-toggletarget"+i).slideToggle("fast"),r({"Toggle button":"pressed","Toggle number":i})}),$("[class^=hx-highlighter]").on("click tap",function(){var t=s(this.className,"hx-highlighter");i.highlightState?$(".hx-highlight"+t).animate({backgroundColor:i.highlightColor},200):$(".hx-highlight"+t).animate({backgroundColor:i.highlightBackground},200),i.highlightState=!i.highlightState,r({"Highlight button":"pressed","Highlight number":t})}),i.hxOpenDiscussion&&($(".discussion-show.control-button").click(),r({Discussion:"auto-opened"}));var a=$(".hx-popup-opener");a.length&&($("map").each(function(i){var t=[];$(this).find("area").each(function(i){t.push('<li class="'+this.className.split(/\s+/)[0]+' hx-popup-opener" title="'+this.title+'"><a href="javascript:;">'+this.title+"</a></li>")});var e="<ul>"+t.join("")+"</ul>";e="<h4>Clickable Areas:</h4>"+e,$(this).after(e)}),a=$(".hx-popup-opener"),a.on("click tap",function(){var i=this.className,t=i.split(/\s+/)[0];$("div."+t).dialog({dialogClass:"hx-popup-dialog",title:$(this).attr("title"),show:{effect:"fade",duration:200},hide:{effect:"fade",duration:100},buttons:{Close:function(){$(this).dialog("close")}}},function(i){$("div."+i).css({display:""}),alert(i)}),r({"Pop-up Dialog":"opened",Dialog:t})}));var c=$('span[class^="hx-footnote"]');if(c.length)for(var d,u,p,f,g,T=0;T<c.length;T++)d=c[T],u=s(d.className,"hx-footnote"),p=$("div.hx-footnote-target"+u),$(d).addClass("hx-footnote-style"),$(d).wrap("<sup></sup>"),f=$('h3:contains("Footnote")'),g=$(f[f.length-1]).parent(),$(p).detach().appendTo(g),$(d).wrap('<a href="#hxfoot'+u+'" name="hxfootback'+u+'"></a>').wrap(),p.prepend('<a name="hxfoot'+u+'"></a>'),p.append('<p><a href="#hxfootback'+u+'">(back)</a></p>');v.length&&(v.slick(i.slickOptions),r({slider:"created"})),x.length&&k.length&&(x.slick(i.slickNavOptions),k.slick(i.slickBigOptions),r({"paired slider":"created"}))}function o(i,t){var e=i.match(/https:\/\/.+.org\//)[0];if("site"==t)return e;var o=i.replace("courses/course","asset"),n=o.indexOf("+"),s=o.indexOf("/",n);return o=o.slice(0,s),o+="+type@asset+block/","partial"==t?o.replace(e,""):o}function n(i){var t=o(i,"partial"),e={};return t=t.split(":")[1],e.institution=t.split("+")[0],e.id=t.split("+")[1],e.run=t.split("+")[2],e}function s(i,t){for(var e=i.split(/\s+/),o=0;o<e.length;o++)if(0===e[o].indexOf(t))return e[o].slice(t.length);return-1}function a(i,t,e){var o={};return i||t?o=i?t?$.extend(!0,{},e,t,i):$.extend(!0,{},e,i):$.extend(!0,{},e,t):e}function l(i){i=i.toString();var t=i.split(":"),e=0;return 3==t.length?e=3600*parseInt(t[0])+60*parseInt(t[1])+Number(t[2]):2==t.length?e=60*parseInt(t[0])+Number(t[1]):1==t.length&&(e=Number(t[0])),e}function r(i){console.log(JSON.stringify(i))}var h={hxOpenDiscussion:!1,makeTOC:!1,collapsedNav:!1,removeAddPostButton:!1,openPageDiscussion:!1,markExternalLinks:!1,highlightColor:"#ff0",highlightBackground:"rgba(0,0,0,0)",highlightState:!0,slickOptions:{arrows:!0,dots:!0,infinite:!0,slidesToShow:3,slidesToScroll:3},slickNavOptions:{asNavFor:".hx-bigslider",variableWidth:!0,focusOnSelect:!0,slidesToShow:3,slidesToScroll:1},slickBigOptions:{asNavFor:".hx-navslider",arrows:!1,dots:!0,fade:!0,adaptiveHeight:!0,slidesToShow:1,slidesToScroll:1},PUPOptions:{width:800,effect:"fade",effectlength:200,myPosition:"center",atPosition:"center",ofTarget:window},VidLinkOptions:{hideLinkAfter:5,effect:"slide",hide:{direction:"down"},show:{direction:"down"},speed:500,location:"bl"}},c=o(window.location.href,"complete");r(c);var d=o(window.location.href,"site");if(d.indexOf("studio")>-1)return void console.log("Running HXJS in studio is probably not great.");var u=n(window.location.href),p=u.institution+"."+u.id+"_"+u.run;r({"HX.js":"enabled"}),r({"course log id":p}),$.getMultiScripts=function(i,t){var e=$.map(i,function(i){return $.getScript((t||"")+i)});return e.push($.Deferred(function(i){$(i.resolve)})),$.when.apply($,e)};var f=[],g={};f.push("hxGlobalOptions.js");var v=$(".hx-slider"),x=$(".hx-navslider"),k=$(".hx-bigslider");(v.length||x.length&&k.length)&&(r({image_slider:"found"}),f.push("slick.js"));var m=$(".video");if(m.length){r({video:"found"}),f.push("HXVideoLinks.js");var b;if(0!==t.length){f.push("HXPopUpProblems.js");var O}}$.getMultiScripts(f,c).done(function(){r({"Loaded scripts":f}),g=hxGlobalOptions?a(i,hxGlobalOptions,h):a(i,{},h),e(g)}).fail(function(){r("Did not load scripts."),g=a(i,{},h),e(g)}),function(i){i.fn.hxKonami=function(t,e){return void 0===e&&(e="38,38,40,40,37,39,37,39,66,65"),this.each(function(){var o=[];i(this).keydown(function(i){for(o.push(i.keyCode);o.length>e.split(",").length;)o.shift();o.toString().indexOf(e)>=0&&(o=[],t(i))})})}}(jQuery),$(window).hxKonami(function(){alert("+30 Lives"),r({"easter egg":"Konami Code"})}),this.hmsToTime=l,this.logThatThing=r};if("undefined"==typeof hxLocalOptions)var hxLocalOptions={};if("undefined"==typeof HXPUPTimer)var HXPUPTimer=[];$(document).ready(function(){HXGlobalJS(hxLocalOptions,HXPUPTimer)});