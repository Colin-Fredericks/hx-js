var HXGlobalJS=function(i,e){function t(i){b.length&&m&&(O=new HXVideoLinks(i.VidLinkOptions),0!==e.length&&(T=new HXPopUpProblems(h.PUPOptions,e)));var t=$("a.hx-vidtime");if(t.on("click tap",function(){var i=l($(this).attr("data-time")),e=$(this).attr("href"),t=e.slice(e.indexOf("#video")),o=t.replace("#video",""),n=e.slice(e.indexOf("/jump_to_id/")+13,e.indexOf("#video")),a=0===e.indexOf("#")?!0:!1;a?(r({"link starts video at time":i}),O.jumpToTime(o,i)):(localStorage.HXVideoLinkGo="true",localStorage.HXVideoLinkUnit=n,localStorage.HXVideoLinkNumber=o,localStorage.HXVideoLinkTime=i,r({"storing video info for jump":{unit:n,"video number":o,time:i}}))}),i.collapsedNav&&($(".sequence-nav").hide(),$(".sequence-bottom").hide(),$(".sequence > .path").hide()),i.removeAddPostButton&&$(".new-post-btn").hide(),i.openPageDiscussion&&$(".discussion-show").click(),i.markExternalLinks&&(console.log("marking external links"),$(".vert .xblock a, .static_tab_wrapper .xblock a").each(function(i,e){var t=$(e).attr("href");"undefined"!=typeof t&&(t.includes("edx.org")||t.includes("jump_to_id")||t.includes("/courses/")||t.includes("cloudfront.net")||t.includes("javascript:void")||"#"==t.slice(0,1)||$(e).append(' <span class="fa fa-external-link"><span class="sr">External link</span></span>'))})),i.makeTOC){$("#seq_content .xblock:first-of-type").prepend('<div id="autoTOC" class="hx-autotoc"></div>');var o="<h3>Table of Contents</h3><ul>",n=$("h3, h4").filter(function(){return $(this).is(":visible")});$("#autoTOC ul");n.each(function(i){$(this).attr("id","TOCLink"+i);var e,t=$(this).text();$(this).is("h3")&&(e=3,$(n[i-1]).is("h3")||0==i?o+='<li class="autotoc'+e+'"><a href="#TOCLink'+i+'">'+t+"</a></li>":$(n[i-1]).is("h4")&&(o+='</ul></li><li class="autotoc'+e+'"><a href="#TOCLink'+i+'">'+t+"</a></li>")),$(this).is("h4")&&(e=4,$(n[i-1]).is("h3")?(i>0&&o.slice(0,o.length-5),o+='<ul><li class="autotoc'+e+'"><a href="#TOCLink'+i+'">'+t+"</a></li>"):$(n[i-1]).is("h4")&&(o+='<li class="autotoc'+e+'"><a href="#TOCLink'+i+'">'+t+"</a></li>"))}),o+="</ul>",$("#autoTOC").append(o)}$("[class^=hx-togglebutton]").on("click tap",function(){var i=a(this.className,"hx-togglebutton");$(".hx-toggletarget"+i).slideToggle("fast"),r({"Toggle button":"pressed","Toggle number":i})}),$("[class^=hx-highlighter]").on("click tap",function(){var e=a(this.className,"hx-highlighter");i.highlightState?$(".hx-highlight"+e).animate({backgroundColor:i.highlightColor},200):$(".hx-highlight"+e).animate({backgroundColor:i.highlightBackground},200),i.highlightState=!i.highlightState,r({"Highlight button":"pressed","Highlight number":e})});var s=$(".hx-popup-opener");s.length&&($("map").each(function(i){var e=[];$(this).find("area").each(function(i){e.push('<li class="'+this.className.split(/\s+/)[0]+' hx-popup-opener" title="'+this.title+'"><a href="javascript:;">'+this.title+"</a></li>")});var t="<ul>"+e.join("")+"</ul>";t="<h4>Clickable Areas:</h4>"+t,$(this).after(t)}),s=$(".hx-popup-opener"),s.on("click tap",function(){var i=this.className,e=i.split(/\s+/)[0];$("div."+e).dialog({dialogClass:"hx-popup-dialog",title:$(this).attr("title"),show:{effect:"fade",duration:200},hide:{effect:"fade",duration:100},buttons:{Close:function(){$(this).dialog("close")}}},function(i){$("div."+i).css({display:""}),alert(i)}),r({"Pop-up Dialog":"opened",Dialog:e})}));var c=$('span[class^="hx-footnote"]');if(c.length)for(var d,p,u,f,g,w=0;w<c.length;w++)d=c[w],p=a(d.className,"hx-footnote"),u=$("div.hx-footnote-target"+p),$(d).addClass("hx-footnote-style"),$(d).wrap("<sup></sup>"),f=$('h3:contains("Footnote")'),g=$(f[f.length-1]).parent(),$(u).detach().appendTo(g),$(d).wrap('<a href="#hxfoot'+p+'" name="hxfootback'+p+'"></a>').wrap(),u.prepend('<a name="hxfoot'+p+'"></a>'),u.append('<p><a href="#hxfootback'+p+'">(back)</a></p>');v.length&&(v.slick(i.slickOptions),r({slider:"created"})),x.length&&k.length&&(x.slick(i.slickNavOptions),k.slick(i.slickBigOptions),r({"paired slider":"created"}))}function o(i,e){i=i.replace("%2B","+"),i=i.replace("%3A",":");var t=i.match(/https:\/\/.+.org\//)[0];if("site"==e)return t;var o=i.replace("courses/course","asset"),n=o.indexOf("+"),a=o.indexOf("/",n);return o=o.slice(0,a),o+="+type@asset+block/","partial"==e?o.replace(t,""):o}function n(i){var e=o(i,"partial"),t={};return e=e.split(":")[1],t.institution=e.split("+")[0],t.id=e.split("+")[1],t.run=e.split("+")[2],t}function a(i,e){for(var t=i.split(/\s+/),o=0;o<t.length;o++)if(0===t[o].indexOf(e))return t[o].slice(e.length);return-1}function s(i,e,t){var o={};return i||e?o=i?e?$.extend(!0,{},t,e,i):$.extend(!0,{},t,i):$.extend(!0,{},t,e):t}function l(i){i=i.toString();var e=i.split(":"),t=0;return 3==e.length?t=3600*parseInt(e[0])+60*parseInt(e[1])+Number(e[2]):2==e.length?t=60*parseInt(e[0])+Number(e[1]):1==e.length&&(t=Number(e[0])),t}function r(i){console.log(JSON.stringify(i))}var h={makeTOC:!1,collapsedNav:!1,removeAddPostButton:!1,openPageDiscussion:!1,markExternalLinks:!1,highlightColor:"#ff0",highlightBackground:"rgba(0,0,0,0)",highlightState:!0,slickOptions:{arrows:!0,dots:!0,infinite:!0,slidesToShow:3,slidesToScroll:3},slickNavOptions:{asNavFor:".hx-bigslider",variableWidth:!0,focusOnSelect:!0,slidesToShow:3,slidesToScroll:1},slickBigOptions:{asNavFor:".hx-navslider",arrows:!1,dots:!0,fade:!0,adaptiveHeight:!0,slidesToShow:1,slidesToScroll:1},PUPOptions:{width:800,effect:"fade",effectlength:200,myPosition:"center",atPosition:"center",ofTarget:window},VidLinkOptions:{hideLinkAfter:5,effect:"slide",hide:{direction:"down"},show:{direction:"down"},speed:500,location:"bl"}},c=o(window.location.href,"complete");r(c);var d=o(window.location.href,"site");if(d.indexOf("studio")>-1)return void console.log("Running HXJS in studio is probably not great.");var p=n(window.location.href),u=p.institution+"."+p.id+"_"+p.run;r({"HX.js":"enabled"}),r({"course log id":u}),$.getMultiScripts=function(i,e){var t=$.map(i,function(i){return $.getScript((e||"")+i)});return t.push($.Deferred(function(i){$(i.resolve)})),$.when.apply($,t)};var f=[],g={};f.push("hxGlobalOptions.js");var v=$(".hx-slider"),x=$(".hx-navslider"),k=$(".hx-bigslider");(v.length||x.length&&k.length)&&(r({image_slider:"found"}),f.push("slick.js"));var m=!0;void 0!==typeof i.dontLoadVideoStuff&&i.dontLoadVideoStuff===!0&&(m=!1,console.log("skipping loading video js"));var b=$(".video");if(m&&b.length){r({video:"found"}),f.push("HXVideoLinks.js");var O;if(0!==e.length){f.push("HXPopUpProblems.js");var T}}$.getMultiScripts(f,c).done(function(){r({"Loaded scripts":f}),g=hxGlobalOptions?s(i,hxGlobalOptions,h):s(i,{},h),t(g)}).fail(function(){r("Did not load scripts."),g=s(i,{},h),t(g)}),function(i){i.fn.hxKonami=function(e,t){return void 0===t&&(t="38,38,40,40,37,39,37,39,66,65"),this.each(function(){var o=[];i(this).keydown(function(i){for(o.push(i.keyCode);o.length>t.split(",").length;)o.shift();o.toString().indexOf(t)>=0&&(o=[],e(i))})})}}(jQuery),$(window).hxKonami(function(){alert("+30 Lives"),r({"easter egg":"Konami Code"})}),this.hmsToTime=l,this.logThatThing=r};if("undefined"==typeof hxLocalOptions)var hxLocalOptions={};if("undefined"==typeof HXPUPTimer)var HXPUPTimer=[];$(document).ready(function(){HXGlobalJS(hxLocalOptions,HXPUPTimer)});